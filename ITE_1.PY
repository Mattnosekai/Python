
import datetime
i4=0
#Paste data between this and ALWAYS ADD fd=sym2 after sym3

sym2=["AABA","MJ","LEG","SBUX","LPX","USMV","ARLP","SERV","JKS","DXJ","PSA","AYX","YNDX","QGEN","CDAY","VLO","EXAS","EMB","FIX","BTI" ]
sym3=["L","S","L","S","L","S","S","S","S","L","S","S","S","L","S","L","S","S","L","L" ]
fd=sym2



for i3 in range(0,len(sym2)):
 
 
 sym=sym2[i3]
 ls=sym3[i3]
 
 if sym=="AABA":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","U","U","U","U","D","U","U","U","U","U","U","U","U","U","U","U","D","D","U","U","D","D","D","D","D","D","D","D","D","D","D","D","D","D","D","D","D","D","D","M" ]
   
 if sym=="MJ":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["D","U","U","D","U","U","D","D","D","D","U","D","D","D","D","D","D","D","D","D","U","U","D","D","D","D","D","D","D","U","D","U","D","U","D","U","U","U","D","D","M" ]
   
 if sym=="LEG":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","U","U","U","U","U","U","D","U","U","U","D","D","U","D","U","U","D","D","D","D","U","U","D","D","D","U","U","U","U","U","U","U","U","U","U","D","U","U","U","M" ]
   
 if sym=="SBUX":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","D","D","D","D","U","D","D","D","U","D","U","D","U","D","U","D","D","U","D","D","U","U","U","D","U","U","D","U","D","U","D","D","D","D","D","U","U","D","U","M" ]
   
 if sym=="LPX":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["D","D","D","U","U","U","D","D","D","U","U","U","D","D","U","U","D","D","D","D","U","U","U","U","U","D","U","U","U","D","U","U","U","D","U","U","D","U","D","D","M" ]
   
 if sym=="USMV":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","D","D","D","D","U","D","D","D","U","D","D","D","U","D","D","D","D","U","D","D","U","U","D","D","U","U","D","D","D","U","D","U","D","D","U","D","D","D","U","M" ]
   
 if sym=="ARLP":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","U","D","U","U","D","D","D","U","D","U","D","U","D","U","U","D","U","U","D","D","D","D","D","D","D","U","D","D","U","D","D","U","U","U","U","D","D","D","D","M" ]
   
 if sym=="SERV":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","D","D","D","D","U","U","D","D","U","D","D","U","D","U","D","D","U","U","D","U","U","U","U","D","D","U","D","D","D","D","D","U","U","D","U","D","D","D","D","M" ]
   
 if sym=="JKS":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","D","D","D","D","U","D","U","U","U","U","U","D","U","D","U","D","D","D","D","D","U","U","U","U","D","U","D","U","U","D","U","D","D","D","U","U","D","D","D","M" ]
   
 if sym=="DXJ":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","U","U","D","U","U","U","U","D","U","U","D","D","U","D","U","U","D","U","D","D","U","U","U","D","U","U","U","D","U","U","D","U","U","D","U","U","U","U","U","M" ]
   
 if sym=="PSA":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","D","D","D","D","U","D","D","U","U","D","D","D","D","U","D","D","D","U","D","U","U","U","U","D","U","D","D","D","D","D","D","U","U","D","D","U","D","D","U","M" ]
   
 if sym=="AYX":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","U","D","D","D","D","D","D","U","U","D","U","D","D","D","D","U","D","U","D","D","U","D","U","D","U","U","U","U","D","D","D","D","D","D","U","D","U","D","D","M" ]
   
 if sym=="YNDX":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","U","D","D","D","D","D","D","U","D","D","D","D","U","D","U","D","D","D","D","D","U","U","U","U","U","D","D","D","D","D","U","D","U","D","D","U","D","U","U","M" ]
   
 if sym=="QGEN":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["D","D","U","D","U","U","U","U","U","U","D","D","U","D","D","U","U","D","U","D","U","U","U","D","D","U","U","U","U","U","U","U","U","D","U","U","U","U","U","D","M" ]
   
 if sym=="CDAY":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","D","D","D","D","D","U","D","U","U","U","D","D","D","D","U","U","D","U","D","D","U","U","U","D","U","D","D","D","U","D","D","D","U","D","U","U","U","D","D","M" ]
   
 if sym=="VLO":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["D","U","U","U","U","U","U","U","U","U","D","D","D","U","D","U","D","U","U","D","D","U","U","D","U","U","U","U","U","U","U","U","U","U","U","U","U","U","U","U","M" ]
   
 if sym=="EXAS":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","U","D","D","D","D","D","D","D","U","D","D","U","D","D","D","D","D","D","D","D","U","U","U","D","U","D","U","U","U","D","D","D","D","D","D","U","U","U","D","M" ]
   
 if sym=="EMB":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","D","U","D","D","D","D","D","U","U","D","U","U","D","D","D","D","D","U","D","D","U","U","D","D","D","D","D","U","U","D","U","U","D","U","U","D","D","D","D","M" ]
   
 if sym=="FIX":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["D","U","D","U","U","U","D","U","U","U","U","U","D","U","U","U","U","U","D","D","D","U","D","D","D","D","U","D","D","U","U","U","U","D","U","U","U","U","D","U","M" ]
   
 if sym=="BTI":
   d_array=["2019-09-04","2019-09-05","2019-09-06","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-28","2019-10-29","2019-10-30" ]
   uod_array=["U","D","U","U","U","U","D","U","D","U","D","D","U","U","D","U","D","U","U","D","D","U","U","U","D","D","U","U","U","U","U","U","U","D","U","U","D","D","D","U","M" ]
   
   

 #Paste Data Above this  
 #print i3

#Long Version


#ls="L" #long short select 
 uod="U" #This is the default, this shows UP Days. Change to "D" to see Down Days.
 uodt="1" #2=Show losing days

 al=0
 zw=0
 zl=0   
 c=0
 avg=0
 c2=0
 avg2=0
 chl=0
 c3=0
 print "=================================================================="

 for i2 in range(0,len(d_array)):

  sd=d_array[i2]
  ed=d_array[i2]


  prices1 = get_pricing([sym],
            start_date=sd,
            end_date=ed,  
            frequency='minute',            
            fields='high'           
                     )

  prices_et=prices1.tz_convert('US/Eastern')

  prices2 = get_pricing([sym],
            start_date=sd,
            end_date=ed,  
            frequency='minute',            
            fields='low'           
                     )

  prices_et2=prices2.tz_convert('US/Eastern')



  data1=prices_et.as_matrix()
  data2=prices_et2.as_matrix()
 
 #data3=prices_et2.loc
  #c=0
  #c2=0 
  t=0  
  t2=0
  t3=0  
  h=0
  l=10000
  b5c1=0
  b5c2=0  
  b5c3=0
  t4=0  

  for i in range(0,len(data1)):
        b5c1=b5c1+1
        if b5c1<7:
          b5c2=t2    
          b5c3=t3
        
        if data1[i]>h and uod_array[i2]=="U" and ls=="L":
          h=data1[i]
          chl=chl+i
          t4=i
          c3=c3+1
            
        if data1[i]<l and uod_array[i2]=="D" and ls=="S":
          l=data1[i]
          chl=chl+i
          t4=i
          c3=c3+1            
        
        if data2[i]<l and uod_array[i2]=="D" and ls=="L":
          l=data2[i]
          c2=c2+1
          avg2=avg2+i
          t=i 
          t2=i  
    
        if data2[i]<l and uod_array[i2]=="U" and ls=="L":
          l=data2[i]
          t=i
          c=c+1
          avg=avg+i
          t2=i  
        
        if data1[i]>h and uod_array[i2]=="U" and ls=="S":
          h=data1[i]
          c2=c2+1
          avg2=avg2+i
          t=i
          t3=i  
            
        if data1[i]>h and uod_array[i2]=="D" and ls=="S":
          h=data1[i]
          t=i
          c=c+1
          avg=avg+i
          t3=i  
 #print(sym+","+sd+","+str(h)+","+str(l)+","+str(ih)+","+str(il)+",")
         
  if b5c2==0 and uod_array[i2]=="U" and ls=="L":
    zw=zw+1
    
  if b5c2==0 and uod_array[i2]=="D" and ls=="L":
    zl=zl+1
    
  if b5c3==0 and uod_array[i2]=="D" and ls=="S":
    zw=zw+1
    
  if b5c3==0 and uod_array[i2]=="U" and ls=="S":
    zl=zl+1  
    
  if b5c2==0 and t>5 and ls=="L" and uod_array[i2]=="U":
    al=al+1
    
  if b5c3==0 and t>5 and ls=="S" and uod_array[i2]=="D":
    al=al+1    

  if uod_array[i2]=="U" and ls=="L" and uodt=="1": #and b5c2==0:
        print(sym+","+"U"+","+sd+","+str(t)+","+str(b5c2)+","+str(t4)+",") 
        #print "========================================LONG VERSION"
 
  if uod_array[i2]=="D" and ls=="S" and uodt=="1": #and b5c3==0:
        print(sym+","+"D"+","+sd+","+str(t)+","+str(b5c3)+","+str(t4)+",") 
        #print "========================================SHORT VERSION"

  if uod_array[i2]=="D" and ls=="L" and uodt=="2": #and b5c2==0:
        print(sym+","+"D"+","+sd+","+str(t)+","+str(b5c2)+",") 
        #print "========================================LONG VERSION"
 
  if uod_array[i2]=="U" and ls=="S" and uodt=="2": #and b5c3==0:
        print(sym+","+"U"+","+sd+","+str(t)+","+str(b5c3)+",") 
        #print "========================================SHORT VERSION"        
  
 if ls=="L":
    print "========================================LONG VERSION"   
  
 if ls=="S":
    print "========================================SHORT VERSION" 

 if zw>0:   
  fd[i4]=sym+","+str(round((zw*100)/(zw+zl)))+"%,"+ls+",      "+str(round(avg/c))+",   "+str(round(chl/c3))+","
  i4=i4+1
    
 print(str(avg/c)) #Main score, the lower the better 
 print(str(avg2/c2)) #the lower the better 
 print " " 
 print(str(round(chl/c3)))    #(str((avg/c)+(avg2/c2))) 
 print " "
 print(str(zw)+"  "+str(zl)+"  "+str(al))   
 print "=================================================================="

for i5 in range(0,i4):
  print(fd[i5])    